# Система анализа состояния дорожного покрытия

## Описание проекта
Веб-приложение для автоматизированного анализа состояния дорожного покрытия с применением компьютерного зрения и искусственного интеллекта. Система позволяет выявлять и классифицировать дефекты по изображениям и видеозаписям, а также формировать экспертные рекомендации по ремонту.

## Основные возможности
- Загрузка изображений и видео дорожного покрытия через веб-интерфейс
- Автоматическая детекция и классификация дефектов с помощью обученной нейросети YOLO
- Поддержка 10 типов дефектов:
  1. D00 — Продольные трещины
  2. D01 — Подтип продольных трещин
  3. D10 — Поперечные трещины
  4. D11 — Подтип поперечных трещин
  5. D20 — Сетчатые трещины
  6. D40 — Выбоины
  7. D43 — Большие выбоины
  8. D44 — Глубокие выбоины
  9. D50 — Колеи, деформации, впадины
  10. Repair area — Зона ремонта
- Визуализация результатов: аннотированные изображения/видео с выделенными дефектами
- Хранение истории загрузок и результатов для каждого пользователя
- Генерация экспертных текстовых рекомендаций по ремонту с помощью GigaChat API
- Личный кабинет пользователя

## Архитектура и технологии
- Backend: Python, Flask, Flask-Login, Flask-SQLAlchemy
- Frontend: HTML5, Bootstrap 5, Jinja2
- База данных: PostgreSQL
- Модель детекции: YOLO (Ultralytics, torch, CUDA)
- Работа с изображениями и видео: Pillow, OpenCV
- Интеграция с ИИ: GigaChat API


## Установка и запуск
1. Клонируйте репозиторий:
   - `git clone <url-репозитория>`
   - Перейдите в папку проекта: `cd <название-папки-проекта>`
2. Создайте виртуальное окружение:
   - `python -m venv venv`
   - Активируйте окружение:
     - Windows: `venv\Scripts\activate`
     - Linux/Mac: `source venv/bin/activate`
3. Установите зависимости:
   - `pip install -r requirements.txt`
4. Настройте базу данных:
   - Установите PostgreSQL, создайте БД `roads`
   - В файле `config.py` пропишите строку подключения и секретный ключ
5. Получите ключ GigaChat API:
   - Зарегистрируйтесь на платформе Sber AI, получите ключ и добавьте его в `routes.py`
6. Инициализируйте БД:
   - В интерактивном режиме Python выполните:
     ```python
     from app import app, db
     with app.app_context():
         db.create_all()
     ```
7. Запустите приложение:
   - `python app.py`
   - Откройте браузер и перейдите по адресу http://localhost:5000

## Использование
1. Зарегистрируйтесь в системе
2. Загрузите изображение или видео дорожного покрытия
3. Дождитесь результатов анализа
4. Просмотрите аннотированные файлы и текстовые рекомендации
5. Скачайте обработанные файлы и просмотрите историю загрузок

## Структура проекта
```
project/
├── app.py              # Основной файл приложения
├── routes.py           # Маршруты и обработчики
├── models.py           # Модели базы данных
├── detect.py           # Модуль детекции
├── config.py           # Конфигурация
├── requirements.txt    # Зависимости
├── static/             # Статические файлы
│   ├── uploads/        # Загруженные изображения
│   └── results/        # Результаты обработки
├── templates/          # HTML шаблоны
└── data.yaml           # Конфигурация датасета
```

## Обучение модели (при необходимости)
1. Подготовьте структуру папок для датасета:
   ```
   dataset/
   ├── images/
   │   ├── train/
   │   └── val/
   └── labels/
       ├── train/
       └── val/
   ```
2. Разместите изображения и аннотации в соответствующих папках
3. Отредактируйте файл `data.yaml` (укажите путь к датасету, количество классов и их имена)
4. Запустите обучение:
   - `yolo train model=yolov8n.pt data=data.yaml epochs=100 imgsz=640`
5. Скопируйте веса модели (`best.pt`) в папку проекта и укажите путь к ним в `detect.py`
